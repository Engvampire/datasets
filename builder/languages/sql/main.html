<!DOCTYPE html>
<html lang="en">
    <head>
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>{{ metadata.name }} Library (CORGIS Datasets Project)</title>
    
    <!-- JQuery UI CSS-->
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">
    
    <!-- JQuery JS -->
    <script src="https://code.jquery.com/jquery-2.1.4.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>
    
    <!-- JQuery UI JS -->
    <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    
    <style>
    .ui-dialog table {
        width: 100%;
        font-size: 10pt;
    }
    
    .ui-dialog td {
        border-bottom: 1px solid #CCC;
        overflow: 
    }
    
    .ui-dialog-content {
        max-height: 400px;
        overflow:auto;
    }
    
    .dialog-opener {
        cursor: pointer;
    }
    
    .ui-widget-header {
        border: 0px solid black;
        border-bottom: 1px solid #ccc;
        background: #cde;
    }
    
    /*.highlight  { background: #2B2B2B; color: #E6E1DC}*/
    .highlight .hll { background-color: #ffffcc }
    .highlight .c { color: #BC9458; font-style: italic} /* Comment */
    .highlight .err { color: #E6E1DC} /* Error */
    /*.highlight .g { color: #E6E1DC} /* Generic */
    .highlight .k { color: #CC7833} /* Keyword */
    /*.highlight .l { color: #E6E1DC} /* Literal */
    /*.highlight .n { color: #E6E1DC} /* Name */
    /*.highlight .o { color: #E6E1DC} /* Operator */
    /*.highlight .x { color: #E6E1DC} /* Other */
    /*.highlight .p { color: #E6E1DC} /* Punctuation */
    /*.highlight .cm { color: #BC9458; font-style: italic} /* Comment.Multiline */
    /*.highlight .cp { color: #CC7833} /* Comment.Preproc */
    /*.highlight .c1 { color: #BC9458; font-style: italic} /* Comment.Single */
    /*.highlight .cs { color: #BC9458; font-style: italic} /* Comment.Special */
    /*.highlight .gd { color: #E6E1DC; background-color: #660000 } /* Generic.Deleted */
    /*.highlight .ge { color: #E6E1DC} /* Generic.Emph */
    /*.highlight .gr { color: #FFFFFF; background-color: #990000 } /* Generic.Error */
    /*.highlight .gh { color: #FFFFFF} /* Generic.Heading */
    /*.highlight .gi { color: #E6E1DC; background-color: #144212 } /* Generic.Inserted */
    /*.highlight .go { color: #E6E1DC} /* Generic.Output */
    /*.highlight .gp { color: #E6E1DC} /* Generic.Prompt */
    /*.highlight .gs { color: #E6E1DC} /* Generic.Strong */
    /*.highlight .gu { color: #FFFFFF} /* Generic.Subheading */
    /*.highlight .gt { color: #E6E1DC} /* Generic.Traceback */
    /*.highlight .kc { color: #CC7833} /* Keyword.Constant */
    /*.highlight .kd { color: #CC7833} /* Keyword.Declaration */
    .highlight .kn { color: #CC7833; font-weight: bold} /* Keyword.Namespace */
    /*.highlight .kp { color: #CC7833} /* Keyword.Pseudo */
    /*.highlight .kr { color: #CC7833} /* Keyword.Reserved */
    /*.highlight .kt { color: #DA4939} /* Keyword.Type */
    /*.highlight .ld { color: #E6E1DC} /* Literal.Date */
    /*.highlight .m { color: #A5C261} /* Literal.Number */
    .highlight .s { color: #A5C261} /* Literal.String */
    /*.highlight .na { color: #FFC66D} /* Name.Attribute */
    /*.highlight .nb { color: #E6E1DC} /* Name.Builtin */
    /*.highlight .nc { color: #E6E1DC} /* Name.Class */
    /*.highlight .no { color: #6D9CBE} /* Name.Constant */
    /*.highlight .nd { color: #E6E1DC} /* Name.Decorator */
    /*.highlight .ni { color: #E6E1DC} /* Name.Entity */
    /*.highlight .ne { color: #E6E1DC} /* Name.Exception */
    /*.highlight .nf { color: #FFC66D} /* Name.Function */
    /*.highlight .nl { color: #E6E1DC} /* Name.Label */
    /*.highlight .nn { color: #E6E1DC} /* Name.Namespace */
    /*.highlight .nx { color: #E6E1DC} /* Name.Other */
    /*.highlight .py { color: #E6E1DC} /* Name.Property */
    /*.highlight .nt { color: #CC7833} /* Name.Tag */
    /*.highlight .nv { color: #D0D0FF} /* Name.Variable */
    /*.highlight .ow { color: #E6E1DC} /* Operator.Word */
    /*.highlight .w { color: #E6E1DC} /* Text.Whitespace */
    /*.highlight .mf { color: #A5C261} /* Literal.Number.Float */
    /*.highlight .mh { color: #A5C261} /* Literal.Number.Hex */
    /*.highlight .mi { color: #A5C261} /* Literal.Number.Integer */
    /*.highlight .mo { color: #A5C261} /* Literal.Number.Oct */
    /*.highlight .sb { color: #A5C261} /* Literal.String.Backtick */
    /*.highlight .sc { color: #A5C261} /* Literal.String.Char */
    /*.highlight .sd { color: #A5C261} /* Literal.String.Doc */
    /*.highlight .s2 { color: #A5C261} /* Literal.String.Double */
    /*.highlight .se { color: #A5C261} /* Literal.String.Escape */
    /*.highlight .sh { color: #A5C261} /* Literal.String.Heredoc */
    /*.highlight .si { color: #A5C261} /* Literal.String.Interpol */
    /*.highlight .sx { color: #A5C261} /* Literal.String.Other */
    /*.highlight .sr { color: #A5C261} /* Literal.String.Regex */
    /*.highlight .s1 { color: #A5C261} /* Literal.String.Single */
    /*.highlight .ss { color: #A5C261} /* Literal.String.Symbol */
    /*.highlight .bp { color: #E6E1DC} /* Name.Builtin.Pseudo */
    /*.highlight .vc { color: #D0D0FF} /* Name.Variable.Class */
    /*.highlight .vg { color: #D0D0FF} /* Name.Variable.Global */
    /*.highlight .vi { color: #D0D0FF} /* Name.Variable.Instance */
    /*.highlight .il { color: #A5C261} /* Literal.Number.Integer.Long */
    </style>
    
    <script>
    var user_id = "";
    if (localStorage.getItem('user_id') !== null) {
        user_id = localStorage.getItem('user_id');
    }
    function log(action, body) {
        $.post('https://think.cs.vt.edu/blockpy/services/log', {
                    'user_id': user_id,
                    'event': 'corgis',
                    'action': action,
                    'body': body
                }, function(data) {
                    console.log(data);
                });
    }
    $(document).ready(function() {
        /*
        log('load', '{{ metadata.name }}');
        function doPoll(){  
            log('remain', '{{ metadata.name }}, '+$(document).scrollTop()+", "+$(document).height());
        }
        setInterval(doPoll, 5000);
        */
    });
    $(function () {
      $('[data-toggle="tooltip"]').tooltip()
    })
    </script>

</head>

<body>

<div class="container">

    <div class="page-header">
        {% if metadata.icon %}
        <img class="img-rounded pull-right" src="{{ metadata.name|snake_case }}.png" alt="{{ metadata.name }}" style="max-width: 128px; max-height: 128px;">
        {% endif %}
        <h1>{{ metadata.name }} Library</h1>
        <p class="lead">From the <a href="../index.html">CORGIS Dataset Project</a></p>
        <span class="text-muted">By {{metadata.author}}</span><br>
        <span class="text-muted">Version {{metadata.version}}, created {{ metadata.datetime}}</span><br>
        <span class="text-muted">Tags: {{ metadata.tags|join(', ')}}</span><br>
    </div>
    
    <h3>Table of Contents</h3>
    <ol>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#downloads">Downloads</a></li>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#documentation">Documentation</a><ol>
        {% for interface in interfaces -%}    
        <li><a href='#{{ interface.name | snake_case }}'>{{ interface.name | snake_case }}</a></li>
        {% endfor %}
        </ol></li>
        {% if metadata.appendix %}
        <li><a href="#appendix">Appendix</a></li>
        {% endif %}
    </ol>
    
    <h3 id="overview">Overview</h3>
    
    <p>
    {{ metadata.description.overview|safe }}
    </p>
    
    {% if metadata.description.citation|safe %}
    <p>
    <i>{{ metadata.description.citation}}</i>
    </p>
    {% endif %}
    
    <h3 id="downloads">Downloads</h3>
    
    <p>Download all of the following files.</p>
    
    <div class='row'>
    <div class="well col-md-6 col-md-offset-1">
    
    <ol>
        <li><a href="{{ metadata.name|snake_case }}.py?forcedownload=1" download="{{ metadata.name|snake_case}}.py" target="_blank">
            <strong>{{ metadata.name|snake_case}}.py </strong>
            <span class='glyphicon glyphicon-download-alt' aria-hidden="true"></span>
        </a></li>
        <li><a href="{{ metadata.name|snake_case }}.db?forcedownload=1" download="{{ metadata.name|snake_case}}.db" target="_blank">
            <strong>{{ metadata.name|snake_case}}.db </strong>
            <span class='glyphicon glyphicon-download-alt' aria-hidden="true"></span>
        </a></li>
    </ol>
    </div>
    </div>
    
    <h3 id="usage">Usage</h3>
    
    This library has {{ interfaces|length }} function{{ 's' if interfaces|length > 1 }} you can use.
    
{% highlight 'python3' %}
import {{ metadata.name | snake_case }}
{% for interface in interfaces -%}
{{ interface.returns|to_python_variable }} = {{ metadata.name | snake_case }}.{{ interface.name | snake_case }}({% for arg in interface.args %}{{arg.default }}{% if not loop.last %}, {%endif %}{% endfor %})
{% endfor %}
{% endhighlight %}

{% if interfaces|rejectattr('test', 'none')|list %}

    Additionally, some of the functions can optionally return Big Data using an extra argument. If you use this Big Data, it may be much slower. Wait until you are sure your code is correct before using these examples.

{% highlight 'python3' %}
import {{ metadata.name | snake_case }}
# These may be slow!
{% for interface in interfaces %}{% if interface.test -%}
{{ interface.returns|to_python_variable }} = {{ metadata.name | snake_case }}.{{ interface.name | snake_case }}({% for arg in interface.args %}{{arg.default }}{% if not loop.last %}, {%endif %}{% endfor %}{% if interface.test %}{% if interface.args %}, {% endif %}test=False{% endif %})
{% endif %}{% endfor %}
{% endhighlight %}

{% endif %}
    
    <h3 id="documentation">Documentation</h3>
    
{% for interface in interfaces -%}    
<h4 id='{{ interface.name | snake_case }}'>{{metadata.name|snake_case}}.{{ interface.name | snake_case }}({% for arg in interface.args %}{{arg.name| snake_case }}{% if not loop.last %}, {% endif %}{% endfor %}{% if interface.test %}{% if interface.args %}, {% endif %}test=True{% endif %})</h4>

<div class='row'>
<div class='col-md-offset-1'>
{{ interface.description }}
</div>
<br>

<ul class="list-group col-md-6 col-md-offset-1">
{% for arg in interface.args %}
<li class="list-group-item">
    <h5 class="list-group-item-heading"><b>{{ arg.name|snake_case }}</b>: <i>{{ arg.type|to_python_type }}</i></h5>
    <p class="list-group-item-text">{{ arg.description }}
    {% if arg.matches %}<br><br>If you make a typo, it will attempt to suggest a corrected answer. However, this is not perfect, so try to be as accurate as possible.{% endif %}
    </p>
</li>
{% endfor %}
{% if interface.test %}
<li class="list-group-item list-group-item-warning">
    <span class="badge">optional</span>
    <h5 class="list-group-item-heading"><b>test</b>: <i>boolean</i></h5>
    <p class="list-group-item-text">Optional argument to control whether ALL or SOME of the data is returned for this function. This makes it much easier to develop and test your code, only using a large (slow) amount of data when you are ready.</p>
</li>
{% endif %}
</ul>

</div>

{% endfor %}

<h3 id="structure">Explore Structure</h3>
{% for name, structure in structures.items() %}
<div class='row'>
    <div class='col-md-2'>
        <button class='btn btn-default' id='btn-explore-{{ name }}'>Explore {{ name }} data</button>
    </div>
</div>

<script>
$(document).ready(function() {
    $("#btn-explore-{{ name }}").click(function() {
        $( "#explore-{{ name }}" ).dialog("open").css({'max-height':"400px", overflow:"auto"});;;
        $('.ui-dialog :button').blur();
    });
});
</script>

{% for path, data in structure.lists.items() %}
    <div id='explore-{{ path|sluggify}}' title='List'>
        {% if data.comment %}
        <div><i>Comment: {{ data.comment }}</i></div>
        {% endif %}
        <table class='table table-condensed table-striped table-bordered' >
            <tr> <th>Index</th> <th>Type</th> <th>Example Value</th></tr>
            <tr> <td>0</td> <td>{{ data.type|to_human_readable_type }}</td> 
                 <td>{{ data.example|convert_example_value("btn-explore-"+data.path|sluggify)}}</td></tr>
            <tr> <td>...</td> <td>...</td> <td>...</td></tr>
        </table>
    </div>
    <script>
    $(document).ready(function() {
        $( "#explore-{{ path|sluggify }}" ).dialog({
          autoOpen: false,
          width: 600
        });
        $("#btn-explore-{{ data.path|sluggify }}").click(function() {
            $( "#explore-{{ data.path|sluggify }}" ).dialog("open").css({'max-height':"400px", overflow:"auto"});;;
            $('.ui-dialog :button').blur();
        });
    });
    </script>
{% endfor %}

{% for path, data in structure.dictionaries.items() %}
    <div id='explore-{{ path|sluggify }}' title='Dictionary ({{ data.fields|length }} keys)'>
        <table class='table table-condensed table-striped table-bordered' >
            <tr> <th>Key</th> <th>Type</th> <th>Example Value</th> <th>Comment</th></tr>
            {% for field in data.fields %}
            <tr> <td><code>{{ field.key|wrap_quotes }}</code></td> 
                 <td>{{ field.type|to_human_readable_type }}</td> 
                 <td>{{ field.example|convert_example_value("btn-explore-"+field.path|sluggify)}}</td> 
                 <td>{{ field.comment }}</td> </tr>
            {% endfor %}
        </table>
    </div>
    <script>
    $(document).ready(function() {
        $( "#explore-{{ path|sluggify }}" ).dialog({
          autoOpen: false,
          width: 600
        });
        {% for field in data.fields %}
        $("#btn-explore-{{ field.path|sluggify }}").click(function() {
            $( "#explore-{{ field.path|sluggify }}" ).dialog("open").css({'max-height':"400px", overflow:"auto"});;
            $('.ui-dialog :button').blur();
        });
        {% endfor %}
    });
    </script>
{% endfor %}

{% endfor %}
    
{% if metadata.appendix %}
    <h3 id="appendix">Appendix</h3>
    
    <div class='row'>
    <div class="well col-md-6 col-md-offset-1">
    
    <ol>
    {% for entry in metadata.appendix %}
        <li><a href="{{ entry.file }}" target="_blank">
            <strong>{{ entry.name}} </strong>
            <span class='glyphicon glyphicon-eye-open' aria-hidden="true"></span>
            {% if entry.description %}:
            {{ entry.description }}
            {% endif %}
        </a></li>
    {% endfor %}
    </ol>
    </div>
    </div>
{% endif %}
    
</div>
